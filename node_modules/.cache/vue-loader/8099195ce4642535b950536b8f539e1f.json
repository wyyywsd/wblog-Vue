{"remainingRequest":"/Users/mac/work_space/vue/wblog/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/work_space/vue/wblog/src/components/UserLogin.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mac/work_space/vue/wblog/src/components/UserLogin.vue","mtime":1624863374897},{"path":"/Users/mac/work_space/vue/wblog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zIH0gZnJvbSAidnVleCI7CgppbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAiZWxlbWVudC11aSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHZhciBjaGVja1VzZXJOYW1lID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcigi55So5oi35ZCN5LiN6IO95Li656m6IikpOwogICAgICB9CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPCAyKSB7CiAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIueUqOaIt+WQjemVv+W6puS4jeiDveWwj+S6juS4pOS9jSIpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICB9CiAgICAgIH0sIDEwMDApOwogICAgfTsKICAgIHZhciB2YWxpZGF0ZVBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGlmICh2YWx1ZSA9PT0gIiIpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+i+k+WFpeWvhueggSIpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodmFsdWUubGVuZ3RoIDwgOCkgewogICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLlr4bnoIHplb/luqbkuI3og73lsI/kuo445L2NIikpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIHJldHVybiB7CiAgICAgIHJ1bGVGb3JtOiB7CiAgICAgICAgdXNlcl9uYW1lOiAiIiwKICAgICAgICBwYXNzOiAiIiwKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBwYXNzOiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogImJsdXIiIH1dLAogICAgICAgIHVzZXJfbmFtZTogW3sgdmFsaWRhdG9yOiBjaGVja1VzZXJOYW1lLCB0cmlnZ2VyOiAiYmx1ciIgfV0sCiAgICAgIH0sCiAgICAgIHRva2VuOiAiIiwKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKCJ1c2VyIiwgewogICAgICBsb2dpbkRpYWxvZ1Zpc2libGU6ICJsb2dpbkRpYWxvZ1Zpc2libGVTdGF0ZSIsCiAgICB9KSwKCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKCJ1c2VyIiwgWyJzZXRBY3Rpb25Mb2dpbkRpYWxvZ1Zpc2libGVTdGF0ZSJdKSwKICAgIC4uLm1hcEFjdGlvbnMoInVzZXIiLCBbInNldEFjdGlvbklzTG9naW5TdGF0ZSJdKSwKICAgIHN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoYXN5bmMgKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICAvL+aPkOS6pOaIkOWKn+WQjiDlgZrnmoTlpITnkIYKICAgICAgICAgIC8v5bCG6KGo5Y2V5Lit55qE55So5oi35ZCN5ZKM5a+G56CBIOaUvuWIsOS4gOS4quWvueixoemHjAogICAgICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICAgICAgdXNlcl9uYW1lOiB0aGlzLnJ1bGVGb3JtLnVzZXJfbmFtZSwKICAgICAgICAgICAgcGFzc193b3JkOiB0aGlzLnJ1bGVGb3JtLnBhc3MsCiAgICAgICAgICB9OwogICAgICAgICAgLy/ov5nph4zmmK/kuIDkuKrlvILmraXnmoTmlrnms5UgIOiwg+WQjuWPsOeahOaOpeWPo+WBmuagoemqjCAg55So5oi35ZCN5a+G56CB5piv5ZCm5q2j56GuCiAgICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy4kaHR0cC5hdXRoKCIvYXV0aCIsIHBhcmFtcyk7CiAgICAgICAgICAvLwogICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KQogICAgICAgICAgaWYgKHJlc3VsdC5kYXRhLmNvZGUgIT09IDIwMDApIHsKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygi5aSx6LSl5LqGIik7CiAgICAgICAgICAgIE1lc3NhZ2Uud2FybmluZyh7CiAgICAgICAgICAgICAgbWVzc2FnZTogcmVzdWx0LmRhdGEubWVzc2FnZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvL+aIkOWKn+iOt+WPlnRva2VuCiAgICAgICAgICAgIGxldCB0b2tlbiA9IHJlc3VsdC5kYXRhLmRhdGEudG9rZW47CiAgICAgICAgICAgIGxldCBjdXJyZW50VXNlciA9IHJlc3VsdC5kYXRhLmN1cnJlbnRVc2VyCiAgICAgICAgICAgCiAgICAgICAgICAgIC8v6I635Y+W5ZCO5bCG5b6X5Yiw55qEdG9rZW7lgqjlrZjlnKggbG9jYWxTdG9yYWdl5LitCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIHRva2VuKTsKICAgICAgICAgICAgLy/lsIblvZPliY3nlKjmiLfkv6Hmga8g5YKo5a2Y5ZyobG9jYWxTdG9yYWdl5LitIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRVc2VyKSDlj6/ku6XlsIblr7nosaHovazmjaLkuLrlrZfnrKbkuLIKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImN1cnJlbnRfdXNlciIsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRVc2VyKSkKICAgICAgICAgICAgLy/osIPnlKggc3RhdGUg5Lit55qEIHNldEFjdGlvbklzTG9naW5TdGF0ZSAg6K6+572uIOW3sue7j+eZu+mZhgogICAgICAgICAgICB0aGlzLnNldEFjdGlvbklzTG9naW5TdGF0ZSh0cnVlKQogICAgICAgICAgICAvL+WkhOeQhue7k+adn+WQjiwg5YWz6Zet55m76ZmG5by556qXCiAgICAgICAgICAgIHRoaXMuc2V0QWN0aW9uTG9naW5EaWFsb2dWaXNpYmxlU3RhdGUoIXRoaXMubG9naW5EaWFsb2dWaXNpYmxlKTsKICAgICAgICAgICAgLy/nu5nkuIDkuKptZXNzYWdlIOaPkOekuueZu+mZhuaIkOWKnwogICAgICAgICAgICBNZXNzYWdlLnN1Y2Nlc3MoeyBtZXNzYWdlOiByZXN1bHQuZGF0YS5tZXNzYWdlIH0pOwogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCEhIik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkge30sCn07Cg=="},{"version":3,"sources":["UserLogin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserLogin.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <el-dialog\n    title=\"登录\"\n    :visible.sync=\"loginDialogVisible\"\n    width=\"30%\"\n    :modal-append-to-body=\"false\"\n    :show-close=\"false\"\n  >\n    <div class=\"login-form\">\n      <el-form\n        :model=\"ruleForm\"\n        status-icon\n        :rules=\"rules\"\n        ref=\"ruleForm\"\n        label-width=\"80px\"\n        class=\"demo-ruleForm\"\n        \n      >\n        <el-form-item label=\"用户名\" prop=\"user_name\">\n          <el-input type=\"text\" v-model=\"ruleForm.user_name\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"密码\" prop=\"pass\">\n          <el-input type=\"password\" v-model=\"ruleForm.pass\" autocomplete=\"off\" show-password></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm('ruleForm')\" size=\"small\">提交</el-button>\n          <el-button @click=\"setActionLoginDialogVisibleState(!loginDialogVisible)\" size=\"small\">取 消</el-button>\n          <el-button @click=\"resetForm('ruleForm')\" size=\"small\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport { mapState, mapActions } from \"vuex\";\n\nimport { Message } from \"element-ui\";\n\nexport default {\n  data() {\n    var checkUserName = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error(\"用户名不能为空\"));\n      }\n      setTimeout(() => {\n        if (value.length < 2) {\n          callback(new Error(\"用户名长度不能小于两位\"));\n        } else {\n          callback();\n        }\n      }, 1000);\n    };\n    var validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入密码\"));\n      } else {\n        if (value.length < 8) {\n          callback(new Error(\"密码长度不能小于8位\"));\n        } else {\n          callback();\n        }\n      }\n    };\n    return {\n      ruleForm: {\n        user_name: \"\",\n        pass: \"\",\n      },\n      rules: {\n        pass: [{ validator: validatePass, trigger: \"blur\" }],\n        user_name: [{ validator: checkUserName, trigger: \"blur\" }],\n      },\n      token: \"\",\n    };\n  },\n\n  computed: {\n    ...mapState(\"user\", {\n      loginDialogVisible: \"loginDialogVisibleState\",\n    }),\n\n  },\n  methods: {\n    ...mapActions(\"user\", [\"setActionLoginDialogVisibleState\"]),\n    ...mapActions(\"user\", [\"setActionIsLoginState\"]),\n    submitForm(formName) {\n      this.$refs[formName].validate(async (valid) => {\n        if (valid) {\n          //提交成功后 做的处理\n          //将表单中的用户名和密码 放到一个对象里\n          let params = {\n            user_name: this.ruleForm.user_name,\n            pass_word: this.ruleForm.pass,\n          };\n          //这里是一个异步的方法  调后台的接口做校验  用户名密码是否正确\n          let result = await this.$http.auth(\"/auth\", params);\n          //\n          console.log(result)\n          if (result.data.code !== 2000) {\n            //console.log(\"失败了\");\n            Message.warning({\n              message: result.data.message,\n            });\n          } else {\n            //成功获取token\n            let token = result.data.data.token;\n            let currentUser = result.data.currentUser\n           \n            //获取后将得到的token储存在 localStorage中\n            localStorage.setItem(\"token\", token);\n            //将当前用户信息 储存在localStorage中 JSON.stringify(currentUser) 可以将对象转换为字符串\n            localStorage.setItem(\"current_user\", JSON.stringify(currentUser))\n            //调用 state 中的 setActionIsLoginState  设置 已经登陆\n            this.setActionIsLoginState(true)\n            //处理结束后, 关闭登陆弹窗\n            this.setActionLoginDialogVisibleState(!this.loginDialogVisible);\n            //给一个message 提示登陆成功\n            Message.success({ message: result.data.message });\n          }\n          console.log(result);\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n  },\n  mounted() {},\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.el-col\n  border-radius 4px\n  height 700px\n.bg-purple\n  height 100%\n.grid-content\n  border-radius 4px\n  min-height 36px\n.login-form\n  color yellow\n  margin-top -20px\n  width 85%\n</style>"]}]}