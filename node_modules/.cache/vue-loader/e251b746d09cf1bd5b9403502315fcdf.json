{"remainingRequest":"/Users/mac/work_space/vue/wblog/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/work_space/vue/wblog/src/components/UpdateUser.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mac/work_space/vue/wblog/src/components/UpdateUser.vue","mtime":1624949242227},{"path":"/Users/mac/work_space/vue/wblog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWUgZnJvbSAidnVlIjsKaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gImVsZW1lbnQtdWkiOwoKVnVlLmNvbXBvbmVudChNZXNzYWdlLm5hbWUsIE1lc3NhZ2UpOwppbXBvcnQgeyBtYXBTdGF0ZSwgbWFwQWN0aW9ucyB9IGZyb20gInZ1ZXgiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHZhciBjaGVja1VzZXJOYW1lID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcigi55So5oi35ZCN5LiN6IO95Li656m6IikpOwogICAgICB9CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPCAyKSB7CiAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIueUqOaIt+WQjemVv+W6puS4jeiDveWwj+S6juS4pOS9jSIpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICB9CiAgICAgIH0sIDEwMDApOwogICAgfTsKICAgIHZhciB2YWxpZGF0ZU9sZFBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIC8v5Y675p+Q5Liq5Zyw5pa55Y+W5pen55qE5a+G56CBIOWSjOaWsOeahOWvhueggeWBmuavlOi+gyAg6L+Z6YeM5Y+v6IO95Lya6YCJ5oupIOWPluacjeWKoeWZqOWPliDlgZrlvILmraXlpITnkIYKICAgICAgY2FsbGJhY2soKTsKICAgIH07CiAgICB2YXIgdmFsaWRhdGVQYXNzID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAodmFsdWUgPT09ICIiKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLor7fovpPlhaXlr4bnoIEiKSk7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUubGVuZ3RoIDwgOCkgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi5a+G56CB6ZW/5bqm5LiN6IO95bCP5LqOOOS9jSIpKTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gdGhpcy5ydWxlRm9ybS5vbGRQYXNzKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLkuI3og73kuI7ml6flr4bnoIHkuIDoh7QiKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMucnVsZUZvcm0uY2hlY2tQYXNzICE9PSAiIikgewogICAgICAgICAgdGhpcy4kcmVmcy5ydWxlRm9ybS52YWxpZGF0ZUZpZWxkKCJjaGVja1Bhc3MiKTsKICAgICAgICB9CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKICAgIHZhciB2YWxpZGF0ZVBhc3MyID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAodmFsdWUgPT09ICIiKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLor7flho3mrKHovpPlhaXlr4bnoIEiKSk7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09IHRoaXMucnVsZUZvcm0ubmV3UGFzcykgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi5Lik5qyh6L6T5YWl5a+G56CB5LiN5LiA6Ie0IikpOwogICAgICB9IGVsc2UgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gewogICAgICBydWxlRm9ybTogewogICAgICAgIHVzZXJOYW1lOiAiIiwKICAgICAgICBvbGRQYXNzOiAiIiwKICAgICAgICBuZXdQYXNzOiAiIiwKICAgICAgICBjaGVja1Bhc3M6ICIiLAogICAgICB9LAogICAgICBpc1VwZGF0ZVBhc3M6IGZhbHNlLAogICAgICBpc1VwZGF0ZVByb2ZpbGVyUGhvdG86IGZhbHNlLAogICAgICBpbWFnZVVybDogIiIsCiAgICAgIGN1cnJlbnRVc2VyOiB7fSwKICAgICAgcnVsZXM6IHsKICAgICAgICB1c2VyTmFtZTogW3sgdmFsaWRhdG9yOiBjaGVja1VzZXJOYW1lLCB0cmlnZ2VyOiAiYmx1ciIgfV0sCiAgICAgICAgb2xkUGFzczogW3sgdmFsaWRhdG9yOiB2YWxpZGF0ZU9sZFBhc3MsIHRyaWdnZXI6ICJibHVyIiB9XSwKICAgICAgICBuZXdQYXNzOiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogImJsdXIiIH1dLAogICAgICAgIGNoZWNrUGFzczogW3sgdmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MyLCB0cmlnZ2VyOiAiYmx1ciIgfV0sCiAgICAgIH0sCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIC8v5Yid5aeL5YyW55So5oi35ZCNCiAgICBsZXQgY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJjdXJyZW50X3VzZXIiKSk7CiAgICB0aGlzLnJ1bGVGb3JtLnVzZXJOYW1lID0gY3VycmVudFVzZXIudXNlcl9uYW1lOwogICAgdGhpcy5jdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyOwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKCJ1c2VyIiwgewogICAgICBVcGRhdGVVc2VyRGlhbG9nVmlzaWJsZTogIlVwZGF0ZVVzZXJEaWFsb2dWaXNpYmxlU3RhdGUiLAogICAgfSksCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKCJ1c2VyIiwgWyJzZXRBY3Rpb25VcGRhdGVVc2VyRGlhbG9nVmlzaWJsZVN0YXRlIl0pLAogICAgaGFuZGxlQXZhdGFyU3VjY2VzcyhyZXMsIGZpbGUpIHsKICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgdGhpcy5pbWFnZVVybCA9IHJlcy51cmw7CiAgICB9LAogICAgYmVmb3JlQXZhdGFyVXBsb2FkKGZpbGUpIHsKICAgICAgY29uc3QgaXNKUEcgPSBmaWxlLnR5cGUgPT09ICJpbWFnZS9qcGVnIjsKICAgICAgY29uc3QgaXNMdDJNID0gZmlsZS5zaXplIC8gMTAyNCAvIDEwMjQgPCAyOwoKICAgICAgaWYgKCFpc0pQRykgewogICAgICAgIE1lc3NhZ2Uud2FybmluZyh7CiAgICAgICAgICBtZXNzYWdlOiAi5LiK5Lyg5aS05YOP5Zu+54mH5Y+q6IO95pivIEpQRyDmoLzlvI8hIiwKICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAoIWlzTHQyTSkgewogICAgICAgIE1lc3NhZ2Uud2FybmluZyh7CiAgICAgICAgICBtZXNzYWdlOiAi5LiK5Lyg5aS05YOP5Zu+54mH5aSn5bCP5LiN6IO96LaF6L+HIDJNQiEiLAogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBpc0pQRyAmJiBpc0x0Mk07CiAgICB9LAogICAgc3VibWl0Rm9ybShmb3JtTmFtZSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZShhc3luYyAodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIC8v5o+Q5Lqk5oiQ5Yqf5ZCOIOWBmueahOWkhOeQhiDov5nph4zkvJrosIPnlKgg5rOo5pu05paw55So5oi35L+h5oGv55qEYXBpCiAgICAgICAgICAvL+i/memHjOWIpOaWreS4gOS4iyAg5aaC5p6c5LuA5LmI6YO95rKh5YqoICDlsLHkuI3osIPnlKjmjqXlj6PkuoYKICAgICAgICAgIC8v5rOo5oSP5LiA5LiLICDnlLHkuo4g5ZCO5Y+w5pu05paw55So55qE5pivbWFwIOaJgOS7pSDov5nph4znmoRwYXJhbXPnmoRrZXkgIOimgeWSjG1vZGVs6YeM55qE5a2X5q615LiA6Ie0CiAgICAgICAgICBsZXQgcGFyYW1zID0ge307CiAgICAgICAgICBpZiAodGhpcy5jdXJyZW50VXNlci51c2VyX25hbWUgIT09IHRoaXMucnVsZUZvcm0udXNlck5hbWUpIHsKICAgICAgICAgICAgcGFyYW1zWyJVc2VyTmFtZSJdID0gdGhpcy5ydWxlRm9ybS51c2VyTmFtZTsKICAgICAgICAgIH0KICAgICAgICAgIC8v5aaC5p6c6YCJ5oup5LqGIOS/ruaUueWktOWDjwogICAgICAgICAgaWYgKHRoaXMuaXNVcGRhdGVQcm9maWxlclBob3RvICYmIHRoaXMuaW1hZ2VVcmwgIT09ICIiKSB7CiAgICAgICAgICAgIHBhcmFtc1siUHJvZmlsZVBob3RvIl0gPSB0aGlzLmltYWdlVXJsOwogICAgICAgICAgfQogICAgICAgICAgLy/lpoLmnpzpgInmi6nkuoYg5L+u5pS55a+G56CBCiAgICAgICAgICBpZiAodGhpcy5pc1VwZGF0ZVBhc3MpIHsKICAgICAgICAgICAgcGFyYW1zWyJQYXNzV29yZCJdID0gdGhpcy5ydWxlRm9ybS5uZXdQYXNzOwogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2cocGFyYW1zKTsKICAgICAgICAgIC8vcGFyYW1zIOS4jeS4uuepuiDlho3osIPmjqXlj6MKICAgICAgICAgIGlmICgie30iICE9PSBKU09OLnN0cmluZ2lmeShwYXJhbXMpKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLosIPmjqXlj6PkuoYiKTsKICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMuJGh0dHAudXBkYXRlVXNlckluZm8oCiAgICAgICAgICAgICAgIi91cGRhdGVfdXNlciIsCiAgICAgICAgICAgICAgcGFyYW1zCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCkKICAgICAgICAgICAgTWVzc2FnZS5zdWNjZXNzKHsKICAgICAgICAgICAgICBtZXNzYWdlOiAi5oiQ5Yqf5LqG5ZaUISIsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgTWVzc2FnZS53YXJuaW5nKHsKICAgICAgICAgICAgICBtZXNzYWdlOiAi5rKh5pyJ5YGa5Lu75L2V5Y+Y5pu0IiwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy9sZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy4kaHR0cC5zaWduVXAoIi9zaWdudXAiLCBwYXJhbXMpOwogICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXN1bHQpOwogICAgICAgICAgLy/lj5bliLDov5Tlm57lgLzlkI7lnKjov5nph4zov5vooYzliKTmlq0KICAgICAgICAgIC8v5aaC5p6cIG1lc3NhZ2XnmoTlgLzkuLog4oCd5rOo5YaM5oiQ5Yqf4oCdIOWwseWFs+mXreW8ueeqlyAgIOWBmuWQjue7reeahOWkhOeQhgogICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXN1bHQuZGF0YS5tZXNzYWdlID09PSAi5rOo5YaM5oiQ5YqfIik7CiAgICAgICAgICAvLyBpZiAocmVzdWx0LmRhdGEubWVzc2FnZSA9PT0gIuazqOWGjOaIkOWKnyIpIHsKICAgICAgICAgIC8vICAgdGhpcy5zZXRBY3Rpb25VcGRhdGVVc2VyRGlhbG9nVmlzaWJsZVN0YXRlKAogICAgICAgICAgLy8gICAgICF0aGlzLlVwZGF0ZVVzZXJEaWFsb2dWaXNpYmxlCiAgICAgICAgICAvLyAgICk7CiAgICAgICAgICAvLyAgIE1lc3NhZ2Uuc3VjY2Vzcyh7CiAgICAgICAgICAvLyAgICAgbWVzc2FnZTogcmVzdWx0LmRhdGEubWVzc2FnZSwKICAgICAgICAgIC8vICAgfSk7CiAgICAgICAgICAvLyB9IGVsc2UgewogICAgICAgICAgLy8gICAvL2NvbnNvbGUubG9nKHJlc3VsdC5kYXRhLm1lc3NhZ2UpOwogICAgICAgICAgLy8gICBNZXNzYWdlLndhcm5pbmcoewogICAgICAgICAgLy8gICAgIG1lc3NhZ2U6IHJlc3VsdC5kYXRhLm1lc3NhZ2UsCiAgICAgICAgICAvLyAgIH0pOwogICAgICAgICAgLy8gfQogICAgICAgICAgLy/lpoLmnpxtZXNzYWdl55qE5YC85LiN5piv4oCc5rOo5YaM5oiQ5Yqf4oCdICDlsLHkuI3lhbPpl63lvLnnqpcgIOi3s+WHuuitpuWRigogICAgICAgICAgLy9hbGVydCgic3VibWl0ISIpOwoKICAgICAgICAgIC8v5aSE55CG57uT5p2f5ZCOLCDlhbPpl63nmbvpmYblvLnnqpcKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCEhIik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["UpdateUser.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UpdateUser.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <el-dialog\n    title=\"更新用户\"\n    :visible.sync=\"UpdateUserDialogVisible\"\n    width=\"40%\"\n    :modal-append-to-body=\"false\"\n    :show-close=\"false\"\n    top=\"50px\"\n  >\n    <div>\n      <el-form\n        :model=\"ruleForm\"\n        status-icon\n        :rules=\"rules\"\n        ref=\"ruleForm\"\n        label-width=\"100px\"\n        class=\"demo-ruleForm\"\n        label-position=\"right\"\n      >\n        <el-form-item label=\"用户名\" prop=\"userName\">\n          <el-input type=\"text\" v-model=\"ruleForm.userName\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"是否修改头像\" prop=\"isUpdateProfilerPhoto\">\n          <el-switch\n            v-model=\"isUpdateProfilerPhoto\"\n            active-text=\"是\"\n            inactive-text=\"否\"\n            autocomplete=\"off\"\n          ></el-switch>\n        </el-form-item>\n        <template v-if=\"isUpdateProfilerPhoto\">\n          <el-form-item label=\"上传图片\" class=\"upload-form\">\n            <el-upload\n              class=\"avatar-uploader\"\n              action=\"/api/v1/uploadUserProfilePhoto\"\n              :show-file-list=\"false\"\n              :on-success=\"handleAvatarSuccess\"\n              :before-upload=\"beforeAvatarUpload\"\n              name=\"profilePhoto\"\n              :data=\"currentUser\"\n            >\n              <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\" />\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n            </el-upload>\n          </el-form-item>\n        </template>\n        <el-form-item label=\"是否修改密码\" prop=\"isUpdatePass\">\n          <el-switch v-model=\"isUpdatePass\" active-text=\"是\" inactive-text=\"否\" autocomplete=\"off\"></el-switch>\n        </el-form-item>\n        <template v-if=\"isUpdatePass\">\n          <el-form-item label=\"旧密码\" prop=\"oldPass\">\n            <el-input type=\"password\" v-model=\"ruleForm.oldPass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"新密码\" prop=\"newPass\">\n            <el-input type=\"password\" v-model=\"ruleForm.newPass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"确认密码\" prop=\"checkPass\">\n            <el-input type=\"password\" v-model=\"ruleForm.checkPass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n        </template>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm('ruleForm')\" size=\"small\">提交</el-button>\n          <el-button\n            @click=\"setActionUpdateUserDialogVisibleState(!UpdateUserDialogVisible)\"\n            size=\"small\"\n          >取 消</el-button>\n          <el-button @click=\"resetForm('ruleForm')\" size=\"small\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport Vue from \"vue\";\nimport { Message } from \"element-ui\";\n\nVue.component(Message.name, Message);\nimport { mapState, mapActions } from \"vuex\";\nexport default {\n  data() {\n    var checkUserName = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error(\"用户名不能为空\"));\n      }\n      setTimeout(() => {\n        if (value.length < 2) {\n          callback(new Error(\"用户名长度不能小于两位\"));\n        } else {\n          callback();\n        }\n      }, 1000);\n    };\n    var validateOldPass = (rule, value, callback) => {\n      //去某个地方取旧的密码 和新的密码做比较  这里可能会选择 取服务器取 做异步处理\n      callback();\n    };\n    var validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入密码\"));\n      } else if (value.length < 8) {\n        callback(new Error(\"密码长度不能小于8位\"));\n      } else if (value === this.ruleForm.oldPass) {\n        callback(new Error(\"不能与旧密码一致\"));\n      } else {\n        if (this.ruleForm.checkPass !== \"\") {\n          this.$refs.ruleForm.validateField(\"checkPass\");\n        }\n        callback();\n      }\n    };\n    var validatePass2 = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.ruleForm.newPass) {\n        callback(new Error(\"两次输入密码不一致\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      ruleForm: {\n        userName: \"\",\n        oldPass: \"\",\n        newPass: \"\",\n        checkPass: \"\",\n      },\n      isUpdatePass: false,\n      isUpdateProfilerPhoto: false,\n      imageUrl: \"\",\n      currentUser: {},\n      rules: {\n        userName: [{ validator: checkUserName, trigger: \"blur\" }],\n        oldPass: [{ validator: validateOldPass, trigger: \"blur\" }],\n        newPass: [{ validator: validatePass, trigger: \"blur\" }],\n        checkPass: [{ validator: validatePass2, trigger: \"blur\" }],\n      },\n    };\n  },\n  mounted() {\n    //初始化用户名\n    let currentUser = JSON.parse(localStorage.getItem(\"current_user\"));\n    this.ruleForm.userName = currentUser.user_name;\n    this.currentUser = currentUser;\n  },\n  computed: {\n    ...mapState(\"user\", {\n      UpdateUserDialogVisible: \"UpdateUserDialogVisibleState\",\n    }),\n  },\n  methods: {\n    ...mapActions(\"user\", [\"setActionUpdateUserDialogVisibleState\"]),\n    handleAvatarSuccess(res, file) {\n      console.log(res);\n      this.imageUrl = res.url;\n    },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === \"image/jpeg\";\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        Message.warning({\n          message: \"上传头像图片只能是 JPG 格式!\",\n        });\n      }\n      if (!isLt2M) {\n        Message.warning({\n          message: \"上传头像图片大小不能超过 2MB!\",\n        });\n      }\n      return isJPG && isLt2M;\n    },\n    submitForm(formName) {\n      this.$refs[formName].validate(async (valid) => {\n        if (valid) {\n          //提交成功后 做的处理 这里会调用 注更新用户信息的api\n          //这里判断一下  如果什么都没动  就不调用接口了\n          //注意一下  由于 后台更新用的是map 所以 这里的params的key  要和model里的字段一致\n          let params = {};\n          if (this.currentUser.user_name !== this.ruleForm.userName) {\n            params[\"UserName\"] = this.ruleForm.userName;\n          }\n          //如果选择了 修改头像\n          if (this.isUpdateProfilerPhoto && this.imageUrl !== \"\") {\n            params[\"ProfilePhoto\"] = this.imageUrl;\n          }\n          //如果选择了 修改密码\n          if (this.isUpdatePass) {\n            params[\"PassWord\"] = this.ruleForm.newPass;\n          }\n          console.log(params);\n          //params 不为空 再调接口\n          if (\"{}\" !== JSON.stringify(params)) {\n            console.log(\"调接口了\");\n            let result = await this.$http.updateUserInfo(\n              \"/update_user\",\n              params\n            );\n            console.log(result)\n            Message.success({\n              message: \"成功了喔!\",\n            });\n          } else {\n            Message.warning({\n              message: \"没有做任何变更\",\n            });\n          }\n\n          //let result = await this.$http.signUp(\"/signup\", params);\n          //console.log(result);\n          //取到返回值后在这里进行判断\n          //如果 message的值为 ”注册成功” 就关闭弹窗   做后续的处理\n          //console.log(result.data.message === \"注册成功\");\n          // if (result.data.message === \"注册成功\") {\n          //   this.setActionUpdateUserDialogVisibleState(\n          //     !this.UpdateUserDialogVisible\n          //   );\n          //   Message.success({\n          //     message: result.data.message,\n          //   });\n          // } else {\n          //   //console.log(result.data.message);\n          //   Message.warning({\n          //     message: result.data.message,\n          //   });\n          // }\n          //如果message的值不是“注册成功”  就不关闭弹窗  跳出警告\n          //alert(\"submit!\");\n\n          //处理结束后, 关闭登陆弹窗\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n  },\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.el-dialog\n  div:first-child\n    margin-top -6px\n    width 90%\n    .el-form\n      .el-form-item\n        .avatar-uploader\n          width 120px\n          .avatar-uploader-icon\n            font-size 28px\n            color #8c939d\n            width 100px\n            height 100px\n            line-height 100px\n            text-align center\n            border 1px dashed #d9d9d9\n            border-radius 6px\n            cursor pointer\n            position relative\n            overflow hidden\n            float left\n            &:hover\n              border-color #409EFF\n          .avatar\n            width 100px\n            height 100px\n            display block\n</style>"]}]}