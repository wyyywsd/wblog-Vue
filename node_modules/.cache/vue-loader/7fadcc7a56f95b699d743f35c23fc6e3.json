{"remainingRequest":"/Users/mac/work_space/vue/wblog/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/work_space/vue/wblog/src/views/home/NewArticle.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mac/work_space/vue/wblog/src/views/home/NewArticle.vue","mtime":1624617312591},{"path":"/Users/mac/work_space/vue/wblog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/work_space/vue/wblog/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zIH0gZnJvbSAidnVleCI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybUFydGljbGVDb250ZW50OiB7CiAgICAgICAgQXJ0aWNsZVRpdGxlOiAiIiwKICAgICAgICBBcnRpY2xlQ29udGVudDogIiIsCiAgICAgICAgQXJ0aWNsZUxhYmVsOiAiIiwKICAgICAgfSwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoImFydGljbGVzIiwgewogICAgICBuZXdBcnRpY2xlRGlhbG9nVmlzaWJsZTogIm5ld0FydGljbGVEaWFsb2dWaXNpYmxlU3RhdGUiLAogICAgfSksCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKCJhcnRpY2xlcyIsIFsic2V0QWN0aW9uTmV3QXJ0aWNsZURpYWxvZ1Zpc2libGVTdGF0ZSJdKSwKICAgIGFzeW5jIHN1Ym1pdEZvcm0oKSB7CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgYXJ0aWNsZV90aXRsZTogdGhpcy5mb3JtQXJ0aWNsZUNvbnRlbnQuQXJ0aWNsZVRpdGxlLAogICAgICAgIGFydGljbGVfY29udGVudDogdGhpcy5mb3JtQXJ0aWNsZUNvbnRlbnQuQXJ0aWNsZUNvbnRlbnQsCiAgICAgIH07CiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCB0aGlzLiRodHRwLmNyZWF0ZUFydGljbGUoIi9jcmVhdGVfYXJ0aWNsZSIsIHBhcmFtcyk7CiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgICAgIHRoaXMuc2V0QWN0aW9uTmV3QXJ0aWNsZURpYWxvZ1Zpc2libGVTdGF0ZShmYWxzZSk7CiAgICB9LAogICAgY2hhbmdlKHZhbHVlLCByZW5kZXIpIHsKICAgICAgLy8gY29uc29sZS5sb2codmFsdWUpOwogICAgICAvL2NvbnNvbGUubG9nKHJlbmRlcik7CiAgICB9LAogICAgLy8g57uR5a6aQGltZ0FkZCBldmVudAogICAgYXN5bmMgJGltZ0FkZChwb3MsICRmaWxlKSB7CiAgICAgIC8vIOesrOS4gOatpS7lsIblm77niYfkuIrkvKDliLDmnI3liqHlmaguCiAgICAgIGxldCBmb3JtZGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICBmb3JtZGF0YS5hcHBlbmQoImltYWdlIiwgJGZpbGUpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLiRyZWZzLm1kKTsKICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMuJGh0dHAudXBMb2FkKCIvdXBsb2FkIiwgZm9ybWRhdGEpCiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCkKICAgICAgbGV0IF9yZXMgPSByZXN1bHQuZGF0YTsKICAgICAgLy8g56ys5LqM5q2lLuWwhui/lOWbnueahHVybOabv+aNouWIsOaWh+acrOWOn+S9jee9rlvlpJbpk77lm77niYfovazlrZjlpLHotKUoaW1nLUFudjYzU1FSLTE1NjQ3MzQ3NjAyNTcpKDApXSAtPiBb5aSW6ZO+5Zu+54mH6L2s5a2Y5aSx6LSlKGltZy1PVlg3dlpTNC0xNTY0NzM0NzYwMjU5KSh1cmwpXQogICAgICB0aGlzLiRyZWZzLm1kLiRpbWcyVXJsKHBvcywgX3Jlcy51cmwpOwogICAKIAoKCiAgICAgIC8vdGhpcy4kaHR0cC51cExvYWQoJy91cGxvYWQnLGZvcm1kYXRhLCB0aGlzLiR2bSkKICAgICAgLy8g56ys5LqM5q2lLuWwhui/lOWbnueahHVybOabv+aNouWIsOaWh+acrOWOn+S9jee9riFbLi4uXSgwKSAtPiAhWy4uLl0odXJsKQogICAgICAvKioKICAgICAgICogJHZtIOaMh+S4um1hdm9uRWRpdG9y5a6e5L6L77yM5Y+v5Lul6YCa6L+H5aaC5LiL5Lik56eN5pa55byP6I635Y+WCiAgICAgICAqIDEuIOmAmui/h+W8leWFpeWvueixoeiOt+WPljogYGltcG9ydCB7bWF2b25FZGl0b3J9IGZyb20gLi4uYCDnrYnmlrnlvI/lvJXlhaXlkI7vvIxgJHZtYOS4umBtYXZvbkVkaXRvcmAKICAgICAgICogMi4g6YCa6L+HJHJlZnPojrflj5Y6IGh0bWzlo7DmmI5yZWYgOiBgPG1hdm9uLWVkaXRvciByZWY9bWQgPjwvbWF2b24tZWRpdG9yPu+8jGAkdm1g5Li6IGB0aGlzLiRyZWZzLm1kYAogICAgICAgKi8KICAgICAgLy8kdm0uJGltZzJVcmwocG9zLCB1cmwpOwogICAgICAKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["NewArticle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"NewArticle.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\n  <el-dialog\n    title=\"写文章\"\n    :visible.sync=\"newArticleDialogVisible\"\n    width=\"80%\"\n    :modal-append-to-body=\"false\"\n    :show-close=\"false\"\n    top=\"50px\"\n  >\n    <div class=\"login-form\">\n      <el-form label-position=\"right\" label-width=\"50px\" :model=\"formArticleContent\">\n        <el-form-item label=\"名称\">\n          <el-input v-model=\"formArticleContent.ArticleTitle\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"内容\">\n          <!-- markdown编辑器 -->\n          <mavon-editor\n            v-model=\"formArticleContent.ArticleContent\"\n            :ishljs=\"true\"\n            codeStyle=\"qtcreator_dark\"\n            :boxShadow=\"false\"\n            placeholder=\"请用markdown编写...\"\n            defaultOpen=\"edit\"\n            ref=\"md\"\n            @imgAdd=\"$imgAdd\"\n            @change=\"change\"\n          />\n        </el-form-item>\n        <el-form-item label=\"标签\">\n          <el-input v-model=\"formArticleContent.ArticleLabel\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm()\" size=\"small\">提交</el-button>\n          <el-button\n            @click=\"setActionNewArticleDialogVisibleState(!newArticleDialogVisible)\"\n            size=\"small\"\n          >取 消</el-button>\n          <el-button @click=\"resetForm('ruleForm')\" size=\"small\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport { mapState, mapActions } from \"vuex\";\nexport default {\n  data() {\n    return {\n      formArticleContent: {\n        ArticleTitle: \"\",\n        ArticleContent: \"\",\n        ArticleLabel: \"\",\n      },\n    };\n  },\n  computed: {\n    ...mapState(\"articles\", {\n      newArticleDialogVisible: \"newArticleDialogVisibleState\",\n    }),\n  },\n  methods: {\n    ...mapActions(\"articles\", [\"setActionNewArticleDialogVisibleState\"]),\n    async submitForm() {\n      let params = {\n        article_title: this.formArticleContent.ArticleTitle,\n        article_content: this.formArticleContent.ArticleContent,\n      };\n      let result = await this.$http.createArticle(\"/create_article\", params);\n      console.log(result);\n      this.setActionNewArticleDialogVisibleState(false);\n    },\n    change(value, render) {\n      // console.log(value);\n      //console.log(render);\n    },\n    // 绑定@imgAdd event\n    async $imgAdd(pos, $file) {\n      // 第一步.将图片上传到服务器.\n      let formdata = new FormData();\n      formdata.append(\"image\", $file);\n      console.log(this.$refs.md);\n      let result = await this.$http.upLoad(\"/upload\", formdata)\n      console.log(result)\n      let _res = result.data;\n      // 第二步.将返回的url替换到文本原位置[外链图片转存失败(img-Anv63SQR-1564734760257)(0)] -> [外链图片转存失败(img-OVX7vZS4-1564734760259)(url)]\n      this.$refs.md.$img2Url(pos, _res.url);\n   \n \n\n\n      //this.$http.upLoad('/upload',formdata, this.$vm)\n      // 第二步.将返回的url替换到文本原位置![...](0) -> ![...](url)\n      /**\n       * $vm 指为mavonEditor实例，可以通过如下两种方式获取\n       * 1. 通过引入对象获取: `import {mavonEditor} from ...` 等方式引入后，`$vm`为`mavonEditor`\n       * 2. 通过$refs获取: html声明ref : `<mavon-editor ref=md ></mavon-editor>，`$vm`为 `this.$refs.md`\n       */\n      //$vm.$img2Url(pos, url);\n      \n    },\n  },\n};\n</script>\n\n<style lang=\"stylus\" scoped></style>"]}]}